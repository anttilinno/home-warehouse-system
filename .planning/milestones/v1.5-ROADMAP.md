# Milestone v1.5: Settings Enhancement

**Status:** ✅ SHIPPED 2026-02-03
**Phases:** 27-29
**Total Plans:** 9

## Overview

Complete user settings experience with profile management, security controls, and account lifecycle.

## Phases

### Phase 27: Account Settings

**Goal**: Users can manage their profile and personalize their experience
**Depends on**: None (new feature area)
**Requirements**: ACCT-01, ACCT-02, ACCT-03
**Plans**: 3 plans

Plans:
- [x] 27-01-PLAN.md — Backend avatar and email update support
- [x] 27-02-PLAN.md — Frontend account settings UI with avatar upload
- [x] 27-03-PLAN.md — Date format preference and application-wide formatting

**Success Criteria:**
1. User can view and edit their full name from the settings page
2. User can change their email address from the settings page
3. User can upload an avatar image that displays in the app header
4. User can select a date format preference that persists across sessions
5. Date format preference is applied throughout the application

### Phase 28: Security Settings

**Goal**: Users can manage password and control active sessions
**Depends on**: Phase 27 (settings page infrastructure)
**Requirements**: SEC-01, SEC-02, SEC-03, SEC-04
**Plans**: 4 plans

Plans:
- [x] 28-01-PLAN.md — Password change UI (frontend)
- [x] 28-02-PLAN.md — Sessions database infrastructure (migration + sqlc)
- [x] 28-03-PLAN.md — Sessions backend (service + handler + auth flow integration)
- [x] 28-04-PLAN.md — Active sessions UI with revocation

**Success Criteria:**
1. User can change their password by providing current password and new password
2. User can view a list of all active sessions showing device type and last activity
3. User can revoke any individual session, logging out that device
4. User can log out all other sessions at once, keeping only current session active

### Phase 29: Account Deletion

**Goal**: Users can permanently delete their account with appropriate safeguards
**Depends on**: Phase 27 (settings page infrastructure)
**Requirements**: ACCT-04
**Plans**: 2 plans

Plans:
- [x] 29-01-PLAN.md — Backend account deletion with sole owner validation
- [x] 29-02-PLAN.md — Frontend delete account dialog with type-to-confirm

**Success Criteria:**
1. User can initiate account deletion from settings page
2. User must confirm deletion with explicit action (type confirmation text or similar)
3. Deletion removes all user data and logs user out
4. Deletion is prevented if user is sole owner of any workspace

---

## Milestone Summary

**Key Decisions:**
- Label/Input pattern for settings forms (consistent with login-form)
- Avatar validates 2MB max size and JPEG/PNG/WebP types client-side
- Form uses isDirty check to disable save button when no changes
- UI-displayed dates use user preference; CSV exports keep ISO format
- Default date format is YYYY-MM-DD (ISO standard)
- Password change uses react-hook-form with zod validation
- Minimum 8 character password requirement
- VARCHAR(64) for refresh_token_hash to store SHA-256 hex encoding
- INET type for ip_address for proper PostgreSQL IP handling
- Session ID stored in context for current session identification
- Cannot revoke current session to prevent self-lockout
- ActiveSessions uses useState/useEffect pattern (not react-query)
- Repository pattern for sole owner query
- Personal workspace excluded from blocking deletion
- Type-to-confirm requires "DELETE" (case-insensitive)

**Issues Resolved:**
- Settings page infrastructure established
- Session tracking added to auth flow
- Account lifecycle complete (create → modify → delete)

**Issues Deferred:**
- Two-factor authentication (SEC-F01)
- Login history with locations (SEC-F02)
- Security keys / WebAuthn (SEC-F03)
- Social account linking (ACCT-F01)
- GDPR data export (ACCT-F02)

**Technical Debt Incurred:**
- None significant

---

_For current project status, see .planning/ROADMAP.md_
