---
phase: 20-mobile-navigation-fab-and-gestures
plan: 05
type: execute
wave: 3
depends_on: ["20-02", "20-03"]
files_modified:
  - frontend/components/dashboard/dashboard-shell.tsx
  - frontend/messages/en.json
  - frontend/messages/fi.json
autonomous: true

must_haves:
  truths:
    - "FAB visible on all mobile dashboard screens except /scan"
    - "FAB shows context-aware actions based on current route"
    - "FAB has 16px margin from bottom-right corner"
    - "Main content has bottom padding to prevent FAB overlap on last items"
  artifacts:
    - path: "frontend/components/dashboard/dashboard-shell.tsx"
      provides: "Dashboard layout with integrated FAB"
      contains: "FloatingActionButton"
  key_links:
    - from: "frontend/components/dashboard/dashboard-shell.tsx"
      to: "@/components/fab"
      via: "import"
      pattern: "import.*FloatingActionButton.*from.*@/components/fab"
    - from: "frontend/components/dashboard/dashboard-shell.tsx"
      to: "@/lib/hooks/use-fab-actions"
      via: "import"
      pattern: "import.*useFABActions"
---

<objective>
Integrate FAB into dashboard layout with context-aware actions

Purpose: Make FAB available on all mobile dashboard screens, showing relevant quick actions
Output: FAB integrated into DashboardShell with context-aware actions via useFABActions
</objective>

<execution_context>
@/home/antti/.claude/get-shit-done/workflows/execute-plan.md
@/home/antti/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/20-mobile-navigation-fab-and-gestures/20-RESEARCH.md
@.planning/phases/20-mobile-navigation-fab-and-gestures/20-02-SUMMARY.md
@.planning/phases/20-mobile-navigation-fab-and-gestures/20-03-SUMMARY.md
@frontend/components/dashboard/dashboard-shell.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Integrate FAB into DashboardShell</name>
  <files>frontend/components/dashboard/dashboard-shell.tsx</files>
  <action>
Update `frontend/components/dashboard/dashboard-shell.tsx` to include the FAB:

1. Add imports at the top:
```typescript
import { FloatingActionButton } from "@/components/fab";
import { useFABActions } from "@/lib/hooks/use-fab-actions";
```

2. Inside the DashboardShell component, after `const { open: shortcutsOpen, setOpen: setShortcutsOpen }`, add:
```typescript
const fabActions = useFABActions();
```

3. Add the FAB component inside the main `<div className="min-h-screen bg-muted/30">`, after the ConflictResolutionDialog and before the closing `</div>`:

```tsx
{/* Floating Action Button (mobile only) */}
{fabActions.length > 0 && <FloatingActionButton actions={fabActions} />}
```

4. Add bottom padding to main content to prevent FAB overlap on mobile. Update the main element:

Change:
```tsx
<main id="main-content" className="flex-1 p-4 md:p-6">{children}</main>
```

To:
```tsx
<main id="main-content" className="flex-1 p-4 md:p-6 pb-20 md:pb-6">{children}</main>
```

The `pb-20` (80px) gives enough space for the 56px FAB + 16px margin + buffer.

Complete diff should look like:
- Import FloatingActionButton and useFABActions
- Call useFABActions() hook
- Add pb-20 md:pb-6 to main content
- Render FAB conditionally (when fabActions.length > 0)
  </action>
  <verify>
```bash
cd frontend && grep -E "FloatingActionButton|useFABActions|pb-20" components/dashboard/dashboard-shell.tsx
```
Should show imports and usage.
  </verify>
  <done>FAB integrated into DashboardShell with context-aware actions</done>
</task>

<task type="auto">
  <name>Task 2: Add FAB translations</name>
  <files>frontend/messages/en.json, frontend/messages/fi.json</files>
  <action>
Add FAB-related translations. Add a new "fab" section to both translation files.

In `frontend/messages/en.json`, add after an appropriate section (e.g., after "scan" or "common"):

```json
"fab": {
  "openActions": "Open quick actions",
  "closeActions": "Close quick actions",
  "scan": "Scan barcode",
  "addItem": "Add item",
  "logLoan": "Log loan",
  "addContainer": "Add container",
  "addLocation": "Add location",
  "quickCount": "Quick count"
}
```

In `frontend/messages/fi.json`, add the Finnish translations:

```json
"fab": {
  "openActions": "Avaa pikatoiminnot",
  "closeActions": "Sulje pikatoiminnot",
  "scan": "Skannaa viivakoodi",
  "addItem": "Lisää tuote",
  "logLoan": "Kirjaa laina",
  "addContainer": "Lisää säiliö",
  "addLocation": "Lisää sijainti",
  "quickCount": "Pikalaskenta"
}
```

Note: These translations are for future i18n integration. Current implementation uses hardcoded English labels for simplicity, matching the existing pattern in Phase 19 scanner components.
  </action>
  <verify>
```bash
cd frontend && grep -A5 '"fab"' messages/en.json messages/fi.json
```
  </verify>
  <done>FAB translations added for English and Finnish</done>
</task>

</tasks>

<verification>
1. FAB imports present: `grep "FloatingActionButton" frontend/components/dashboard/dashboard-shell.tsx`
2. Hook usage present: `grep "useFABActions" frontend/components/dashboard/dashboard-shell.tsx`
3. Bottom padding added: `grep "pb-20" frontend/components/dashboard/dashboard-shell.tsx`
4. Translations exist: `grep "fab" frontend/messages/en.json`
5. TypeScript compiles: `cd frontend && npx tsc --noEmit`
</verification>

<success_criteria>
- FAB renders on mobile dashboard screens
- FAB hidden on /dashboard/scan (fabActions.length === 0)
- Main content has bottom padding to prevent FAB overlap
- FAB shows context-aware actions per route
- Translations added for future i18n
</success_criteria>

<output>
After completion, create `.planning/phases/20-mobile-navigation-fab-and-gestures/20-05-SUMMARY.md`
</output>
