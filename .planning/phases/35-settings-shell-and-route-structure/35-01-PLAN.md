---
phase: 35-settings-shell-and-route-structure
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/components/settings/settings-row.tsx
  - frontend/components/settings/settings-nav.tsx
  - frontend/app/[locale]/(dashboard)/dashboard/settings/layout.tsx
  - frontend/messages/en.json
  - frontend/messages/et.json
  - frontend/messages/ru.json
autonomous: true

must_haves:
  truths:
    - "Desktop settings pages show a persistent sidebar navigation with active state highlighting"
    - "Sidebar navigation lists Overview, Profile, Appearance, Language, Regional Formats, Security, Notifications, Data & Storage"
    - "All navigation labels are translated in en, et, and ru"
    - "Settings pages share a layout with h1 title, description, and sidebar"
  artifacts:
    - path: "frontend/components/settings/settings-row.tsx"
      provides: "Reusable hub row component with icon, label, description, preview, chevron"
      exports: ["SettingsRow"]
    - path: "frontend/components/settings/settings-nav.tsx"
      provides: "Desktop sidebar navigation for settings with active state"
      exports: ["SettingsNav"]
    - path: "frontend/app/[locale]/(dashboard)/dashboard/settings/layout.tsx"
      provides: "Shared settings layout with h1, sidebar (desktop), and content area"
      exports: ["default"]
    - path: "frontend/messages/en.json"
      provides: "English translations for settings.nav.* and settings.hub.* keys"
      contains: "settings.nav.overview"
    - path: "frontend/messages/et.json"
      provides: "Estonian translations for settings.nav.* and settings.hub.* keys"
      contains: "settings.nav.overview"
    - path: "frontend/messages/ru.json"
      provides: "Russian translations for settings.nav.* and settings.hub.* keys"
      contains: "settings.nav.overview"
  key_links:
    - from: "frontend/components/settings/settings-nav.tsx"
      to: "@/i18n/navigation"
      via: "Link and usePathname imports"
      pattern: "usePathname|Link.*from.*@/i18n/navigation"
    - from: "frontend/app/[locale]/(dashboard)/dashboard/settings/layout.tsx"
      to: "frontend/components/settings/settings-nav.tsx"
      via: "SettingsNav import and render in aside"
      pattern: "SettingsNav"
---

<objective>
Create the settings shell infrastructure: reusable components (SettingsRow, SettingsNav), the shared settings layout with responsive sidebar, and all i18n translation keys for the hub and navigation.

Purpose: Provides the foundational layout and components that the hub page and stub subpages (Plan 02) will use. Establishes the desktop sidebar navigation pattern and ensures all labels are translated.

Output: Two new components, one new layout file, and i18n keys added to all three locale files.
</objective>

<execution_context>
@/home/antti/.claude/get-shit-done/workflows/execute-plan.md
@/home/antti/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/35-settings-shell-and-route-structure/35-RESEARCH.md
@frontend/app/[locale]/(dashboard)/dashboard/settings/page.tsx
@frontend/components/dashboard/sidebar.tsx
@frontend/components/dashboard/dashboard-shell.tsx
@frontend/i18n/config.ts
@frontend/i18n/navigation.ts
@frontend/messages/en.json
@frontend/messages/et.json
@frontend/messages/ru.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SettingsRow and SettingsNav components</name>
  <files>
    frontend/components/settings/settings-row.tsx
    frontend/components/settings/settings-nav.tsx
  </files>
  <action>
    Create `settings-row.tsx`:
    - "use client" component
    - Props interface: `{ icon: LucideIcon; label: string; description: string; href: string; preview?: string }`
    - Wraps an i18n-aware `Link` from `@/i18n/navigation` (NEVER `next/link`)
    - Layout: flex row with icon in 10x10 rounded muted bg, label+description stacked in flex-1, optional preview text (hidden on small screens via `hidden sm:block`), ChevronRight at end
    - Styling: `p-4 rounded-lg border hover:bg-muted/50 transition-colors` on the Link wrapper
    - Export named: `SettingsRow`

    Create `settings-nav.tsx`:
    - "use client" component
    - Define `navItems` array with 8 entries:
      1. `{ href: "/dashboard/settings", labelKey: "nav.overview" }`
      2. `{ href: "/dashboard/settings/profile", labelKey: "nav.profile" }`
      3. `{ href: "/dashboard/settings/appearance", labelKey: "nav.appearance" }`
      4. `{ href: "/dashboard/settings/language", labelKey: "nav.language" }`
      5. `{ href: "/dashboard/settings/regional-formats", labelKey: "nav.regionalFormats" }`
      6. `{ href: "/dashboard/settings/security", labelKey: "nav.security" }`
      7. `{ href: "/dashboard/settings/notifications", labelKey: "nav.notifications" }`
      8. `{ href: "/dashboard/settings/data-storage", labelKey: "nav.dataStorage" }`
    - Use `useTranslations("settings")` for label text
    - Use `usePathname()` from `@/i18n/navigation` for active state detection
    - Active state logic: exact match for hub (`pathname === "/dashboard/settings"`), prefix match for subpages (`pathname.startsWith(item.href)`). This prevents the hub item from being active on subpages.
    - Active styling: `bg-primary text-primary-foreground` for active, `text-muted-foreground hover:bg-muted hover:text-foreground` for inactive
    - All links use `Link` from `@/i18n/navigation`
    - Export named: `SettingsNav`
  </action>
  <verify>
    Run `cd /home/antti/Repos/Misc/home-warehouse-system/frontend && npx tsc --noEmit --pretty` -- no type errors in the two new files.
  </verify>
  <done>
    `SettingsRow` renders a tappable row with icon, label, description, optional preview, and chevron. `SettingsNav` renders 8 sidebar links with correct active state detection using i18n-aware navigation.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create settings layout with responsive sidebar</name>
  <files>
    frontend/app/[locale]/(dashboard)/dashboard/settings/layout.tsx
  </files>
  <action>
    Create `layout.tsx` as a "use client" component (needs `useTranslations`):
    - Accept `{ children: React.ReactNode }` props
    - Use `useTranslations("settings")` for title and description
    - Render structure:
      ```
      <div className="space-y-6">
        <div>
          <h1 className="text-3xl font-bold tracking-tight">{t("title")}</h1>
          <p className="text-muted-foreground">{t("description")}</p>
        </div>
        <div className="flex gap-8">
          <aside className="hidden md:block w-56 shrink-0">
            <SettingsNav />
          </aside>
          <div className="flex-1 min-w-0">
            {children}
          </div>
        </div>
      </div>
      ```
    - Import `SettingsNav` from `@/components/settings/settings-nav`
    - Do NOT add outer padding (DashboardShell's `<main>` already provides `p-4 md:p-6`)
    - The h1 is rendered ONCE here. Subpages render h2-level headers. The hub page does NOT render its own h1.

    IMPORTANT: The existing `settings/page.tsx` currently renders its own h1 header ("Settings" title and description). After this layout is added, the page will show a DUPLICATE header. This is expected -- Plan 02 will rewrite page.tsx and remove the duplicate. Do not modify page.tsx in this task.
  </action>
  <verify>
    Run `cd /home/antti/Repos/Misc/home-warehouse-system/frontend && npx tsc --noEmit --pretty` -- no type errors. Visually confirm the layout file exists and imports SettingsNav correctly.
  </verify>
  <done>
    Settings layout wraps all settings routes with a shared h1 title/description header and a desktop-only sidebar. On mobile (below md breakpoint), only the content area is visible -- the hub page serves as mobile navigation.
  </done>
</task>

<task type="auto">
  <name>Task 3: Add i18n translation keys for settings navigation and hub</name>
  <files>
    frontend/messages/en.json
    frontend/messages/et.json
    frontend/messages/ru.json
  </files>
  <action>
    Add the following keys under the existing `"settings"` object in all three locale files. These keys go at the top level of the settings object (alongside existing keys like "title", "description", "account", etc.).

    **en.json** -- add inside `"settings": { ... }`:
    ```json
    "nav": {
      "overview": "Overview",
      "profile": "Profile",
      "appearance": "Appearance",
      "language": "Language",
      "regionalFormats": "Regional Formats",
      "security": "Security",
      "notifications": "Notifications",
      "dataStorage": "Data & Storage"
    },
    "hub": {
      "preferences": "Preferences",
      "systemSecurity": "System & Security",
      "appearanceDesc": "Theme and display settings",
      "languageDesc": "App language preference",
      "regionalFormatsDesc": "Date, time, and number formats",
      "securityDesc": "Password, sessions, and account",
      "notificationsDesc": "Notification preferences",
      "dataStorageDesc": "Offline data and storage management",
      "light": "Light",
      "dark": "Dark",
      "system": "System"
    }
    ```

    **et.json** -- add inside `"settings": { ... }`:
    ```json
    "nav": {
      "overview": "Ulevaade",
      "profile": "Profiil",
      "appearance": "Valimus",
      "language": "Keel",
      "regionalFormats": "Piirkondlikud vormingud",
      "security": "Turvalisus",
      "notifications": "Teavitused",
      "dataStorage": "Andmed ja salvestus"
    },
    "hub": {
      "preferences": "Eelistused",
      "systemSecurity": "Susteem ja turvalisus",
      "appearanceDesc": "Teema ja kuva seaded",
      "languageDesc": "Rakenduse keele eelistus",
      "regionalFormatsDesc": "Kuupaeva, kellaaja ja numbri vormingud",
      "securityDesc": "Parool, seansid ja konto",
      "notificationsDesc": "Teavituste eelistused",
      "dataStorageDesc": "Vorguta andmed ja salvestushaldus",
      "light": "Hele",
      "dark": "Tume",
      "system": "Susteem"
    }
    ```

    **ru.json** -- add inside `"settings": { ... }`:
    ```json
    "nav": {
      "overview": "Obzor",
      "profile": "Profil'",
      "appearance": "Oformlenie",
      "language": "Yazyk",
      "regionalFormats": "Regional'nye formaty",
      "security": "Bezopasnost'",
      "notifications": "Uvedomleniya",
      "dataStorage": "Dannye i khranilishche"
    },
    "hub": {
      "preferences": "Nastroyki",
      "systemSecurity": "Sistema i bezopasnost'",
      "appearanceDesc": "Tema i nastroyki otobrazheniya",
      "languageDesc": "Yazyk prilozheniya",
      "regionalFormatsDesc": "Formaty daty, vremeni i chisel",
      "securityDesc": "Parol', sessii i akkaunt",
      "notificationsDesc": "Nastroyki uvedomleniy",
      "dataStorageDesc": "Oflayn-dannye i upravlenie khranilishchem",
      "light": "Svetlaya",
      "dark": "Temnaya",
      "system": "Sistemnaya"
    }
    ```

    NOTE: The Estonian and Russian translations should use proper Unicode characters (diacritics, Cyrillic). The transliterated versions above are simplified -- use proper characters:
    - Estonian: "Ulevaade" -> "Ulevaade" (Estonian doesn't need diacritics for these specific words, but double-check: "Susteem" -> "Susteem", "Kuupaeva" -> "Kuupaeva" etc. -- these are acceptable Estonian)
    - Russian: Use actual Cyrillic: "Obzor" -> "Обзор", "Profil'" -> "Профиль", "Oformlenie" -> "Оформление", "Yazyk" -> "Язык", "Regional'nye formaty" -> "Региональные форматы", "Bezopasnost'" -> "Безопасность", "Uvedomleniya" -> "Уведомления", "Dannye i khranilishche" -> "Данные и хранилище", "Nastroyki" -> "Настройки", "Sistema i bezopasnost'" -> "Система и безопасность", "Tema i nastroyki otobrazheniya" -> "Тема и настройки отображения", "Yazyk prilozheniya" -> "Язык приложения", "Formaty daty, vremeni i chisel" -> "Форматы даты, времени и чисел", "Parol', sessii i akkaunt" -> "Пароль, сессии и аккаунт", "Nastroyki uvedomleniy" -> "Настройки уведомлений", "Oflayn-dannye i upravlenie khranilishchem" -> "Офлайн-данные и управление хранилищем", "Svetlaya" -> "Светлая", "Temnaya" -> "Тёмная", "Sistemnaya" -> "Системная"

    For Estonian hub keys use proper Estonian:
    - "Eelistused" (Preferences)
    - "Susteem ja turvalisus" -> "Susteemi ja turvalisus" or simply "Susteem ja turvalisus" -- follow existing pattern in et.json
    - "Teema ja kuva seaded" (Theme and display settings)
    - "Rakenduse keele eelistus" (App language preference)
    - "Kuupaeva, kellaaja ja numbri vormingud" -> "Kuupaeva-, kellaaja- ja numbrivormingud"
    - "Parool, seansid ja konto" (Password, sessions, and account)
    - "Teavituste eelistused" (Notification preferences)
    - "Vorguta andmed ja salvestushaldus" -> "Vorguta andmed ja malu haldamine" or "Offline-andmed ja salvestushaldus"
    - "Hele" (Light), "Tume" (Dark), "Susteem" (System)

    Read each JSON file first, then add the keys. Place `"nav"` and `"hub"` right after the `"comingSoon"` key inside the settings object.
  </action>
  <verify>
    Run `cd /home/antti/Repos/Misc/home-warehouse-system/frontend && node -e "const en = require('./messages/en.json'); console.log(en.settings.nav.overview, en.settings.hub.preferences);"` -- should print "Overview Preferences".
    Run similar checks for et.json and ru.json.
    Run `npx tsc --noEmit --pretty` -- no type errors.
  </verify>
  <done>
    All three locale files contain `settings.nav.*` (8 keys) and `settings.hub.*` (11 keys) translations. English, Estonian, and Russian labels are complete.
  </done>
</task>

</tasks>

<verification>
- `npx tsc --noEmit` passes with no errors
- `settings-row.tsx` exports `SettingsRow` with correct props interface
- `settings-nav.tsx` exports `SettingsNav` with 8 nav items and active state logic
- `layout.tsx` renders h1 header + sidebar (desktop) + children
- en.json, et.json, ru.json all contain `settings.nav.*` and `settings.hub.*` keys
- No modifications to existing `settings/page.tsx` (that is Plan 02)
</verification>

<success_criteria>
- Two new components (`settings-row.tsx`, `settings-nav.tsx`) compile without errors and follow existing codebase patterns
- Settings layout renders a shared header and desktop sidebar with responsive hiding
- All 19 new i18n keys present in all 3 locale files (8 nav + 11 hub)
- TypeScript compilation passes
</success_criteria>

<output>
After completion, create `.planning/phases/35-settings-shell-and-route-structure/35-01-SUMMARY.md`
</output>
