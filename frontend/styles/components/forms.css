/* ==========================================================================
   Form Components
   Input, label, select, checkbox, and form layout styles
   ========================================================================== */

@layer components {
  /* Form container */
  .retro-form {
    @apply space-y-4;
  }

  /* Form group - label + input wrapper */
  .retro-form-group {
    @apply space-y-2;
  }

  /* Form row - horizontal layout */
  .retro-form-row {
    @apply grid gap-3;
  }

  .retro-form-row--2 {
    @apply grid-cols-2;
  }

  .retro-form-row--3 {
    @apply grid-cols-3;
  }

  .retro-form-row--4 {
    @apply grid-cols-4;
  }

  /* Label */
  .retro-label {
    @apply block retro-heading text-foreground;
  }

  .retro-label--required::after {
    content: ' *';
    @apply text-primary;
  }

  /* Base input styles */
  .retro-input {
    @apply w-full px-3 py-2 border-4 border-border;
    @apply bg-background text-foreground retro-body;
    @apply focus:outline-none focus:border-primary;
    @apply transition-colors;
  }

  .retro-input::placeholder {
    @apply text-muted-foreground;
  }

  .retro-input:disabled,
  .retro-input--disabled {
    @apply bg-muted cursor-not-allowed opacity-75;
  }

  .retro-input--error {
    @apply border-primary;
  }

  .retro-input--mono {
    @apply font-mono;
  }

  .retro-input--sm {
    @apply px-2 py-1 text-sm;
  }

  .retro-input--lg {
    @apply px-4 py-3;
  }

  /* Textarea */
  .retro-textarea {
    @apply w-full px-3 py-2 border-4 border-border;
    @apply bg-background text-foreground retro-body;
    @apply focus:outline-none focus:border-primary;
    @apply transition-colors resize-none;
    min-height: 80px;
  }

  .retro-textarea--resizable {
    @apply resize-y;
  }

  /* Select */
  .retro-select {
    @apply w-full px-3 py-2 border-4 border-border;
    @apply bg-background text-foreground retro-body;
    @apply focus:outline-none focus:border-primary;
    @apply transition-colors;
    @apply appearance-none cursor-pointer;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23666' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 12px center;
    padding-right: 36px;
  }

  .retro-select:disabled {
    @apply cursor-not-allowed;
  }

  /* Checkbox */
  .retro-checkbox {
    @apply w-5 h-5 border-4 border-border bg-background;
    @apply accent-primary cursor-pointer;
    @apply appearance-none;
  }

  .retro-checkbox:checked {
    @apply bg-primary;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='white' d='M10 3L4.5 8.5 2 6'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: center;
  }

  .retro-checkbox:disabled {
    @apply cursor-not-allowed opacity-50;
  }

  /* Checkbox with label wrapper */
  .retro-checkbox-group {
    @apply flex items-center gap-3;
  }

  .retro-checkbox-label {
    @apply retro-heading text-foreground cursor-pointer;
  }

  /* Radio button */
  .retro-radio {
    @apply w-5 h-5 border-4 border-border bg-background;
    @apply accent-primary cursor-pointer;
  }

  .retro-radio:checked {
    @apply bg-primary;
  }

  /* Radio group */
  .retro-radio-group {
    @apply space-y-2;
  }

  .retro-radio-item {
    @apply flex items-center gap-3;
  }

  /* Switch/Toggle (simplified) */
  .retro-switch {
    @apply w-10 h-5 border-4 border-border bg-muted;
    @apply cursor-pointer relative;
    @apply transition-colors;
  }

  .retro-switch::after {
    content: '';
    @apply absolute top-0 left-0 w-3 h-3 bg-border;
    @apply transition-transform;
  }

  .retro-switch:checked {
    @apply bg-primary;
  }

  .retro-switch:checked::after {
    @apply translate-x-5 bg-white;
  }

  /* Error message */
  .retro-error {
    @apply text-primary retro-small;
  }

  /* Hint/Help text */
  .retro-hint {
    @apply text-muted-foreground retro-caption;
  }

  /* Form divider */
  .retro-form-divider {
    @apply border-t-4 border-border pt-4 mt-4;
  }

  /* Input with icon */
  .retro-input-icon {
    @apply relative;
  }

  .retro-input-icon .retro-input {
    @apply pl-10;
  }

  .retro-input-icon__icon {
    @apply absolute left-3 top-1/2 -translate-y-1/2;
    @apply w-4 h-4 text-muted-foreground;
  }

  /* Input with button */
  .retro-input-group {
    @apply flex;
  }

  .retro-input-group .retro-input {
    @apply flex-1;
  }

  .retro-input-group .retro-btn {
    @apply -ml-1;
  }

  /* Search input */
  .retro-search {
    @apply w-full px-3 py-2 border-4 border-border;
    @apply bg-background text-foreground retro-body;
    @apply focus:outline-none focus:border-primary;
    @apply transition-colors pl-10;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%23666' stroke-width='2'%3E%3Ccircle cx='11' cy='11' r='8'/%3E%3Cpath d='m21 21-4.35-4.35'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: 12px center;
  }

  /* File input */
  .retro-file {
    @apply w-full px-3 py-2 border-4 border-border;
    @apply bg-background text-foreground retro-body;
    @apply focus:outline-none focus:border-primary;
    @apply transition-colors cursor-pointer;
  }

  .retro-file::file-selector-button {
    @apply mr-3 px-3 py-1 border-2 border-border bg-muted;
    @apply retro-button cursor-pointer;
  }

  /* Color input */
  .retro-color {
    @apply w-12 h-10 border-4 border-border p-1;
    @apply cursor-pointer;
  }

  .retro-color::-webkit-color-swatch-wrapper {
    @apply p-0;
  }

  .retro-color::-webkit-color-swatch {
    @apply border-0;
  }

  /* ==========================================================================
     Dropdown / Autocomplete
     ========================================================================== */

  .retro-dropdown {
    @apply absolute z-10 w-full mt-1;
    @apply bg-card border-4 border-border;
    @apply max-h-48 overflow-y-auto;
    box-shadow: 4px 4px 0px 0px var(--border);
  }

  .retro-dropdown__item {
    @apply w-full px-3 py-2 text-left;
    @apply hover:bg-muted/50 transition-colors;
    @apply border-b-2 border-dashed border-border last:border-b-0;
  }

  .retro-dropdown__empty {
    @apply px-3 py-2 retro-small text-muted-foreground;
  }

  /* Selected user/item display */
  .retro-selected-user {
    @apply flex items-center gap-2 px-3 py-2;
    @apply border-4 border-border bg-muted/50;
  }

  .retro-selected-preview {
    @apply mt-2 flex items-center gap-2 px-3 py-2;
    @apply border-4 border-dashed;
    border-color: var(--nes-green);
    background-color: color-mix(in srgb, var(--nes-green) 10%, transparent);
  }
}
